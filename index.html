<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PillWars - The Crypto Arena</title>
    <!-- FAVICON -->
    <link rel="icon" href="img/web.png">

    <!-- FUENTES -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Russo+One&display=swap" rel="stylesheet">
    
    <style>
        /* --- VARIABLES & RESET --- */
        :root {
            --primary: #00ff88; 
            --primary-dim: rgba(0, 255, 136, 0.1); 
            --accent: #ff2a2a;
            --gold: #ffcc00;
            --bg-dark: #050505; 
            --glass-bg: rgba(20, 20, 20, 0.6); 
            --glass-border: rgba(255, 255, 255, 0.1);
            --navbar-height: 80px;
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        /* CUADRICULA VERDE GLOBAL */
        body {
            margin: 0; padding: 0; background-color: var(--bg-dark);
            background-image: 
                linear-gradient(rgba(0, 255, 136, 0.05) 1.5px, transparent 1.5px),
                linear-gradient(90deg, rgba(0, 255, 136, 0.05) 1.5px, transparent 1.5px);
            background-size: 50px 50px; 
            color: #e0e0e0; font-family: 'Inter', sans-serif;
            overflow-x: hidden; scroll-behavior: smooth;
            cursor: none; /* Por defecto para PC */
        }

        /* CURSOR PERSONALIZADO (SOLO PC) */
        #custom-cursor {
            position: fixed; top: 0; left: 0; width: 24px; height: 44px;
            background: linear-gradient(180deg, #ffffff 50%, #00ff88 50%);
            border: 2px solid #000; border-radius: 20px; pointer-events: none; z-index: 100000;
            transform: translate(-50%, -50%) rotate(-30deg); box-shadow: 0 0 15px var(--primary);
            will-change: transform, top, left; transition: opacity 0.1s ease; opacity: 1; 
            display: none; 
        }
        #custom-cursor.clicking { transform: translate(-50%, -50%) rotate(-30deg) scale(0.9); filter: brightness(1.3); }

        /* ZONAS SEGURAS (CURSOR NATIVO) */
        .navbar, .navbar *, footer, footer *, .modal-overlay, .modal-box, .modal-box * { cursor: default !important; }
        .navbar a, .navbar button, .wallet-option, footer a, .modal-close { cursor: pointer !important; }
        /* El trailer box ahora tiene cursor pointer manejado abajo */
        .btn-play, .ca-box, .skill-card, .video-card, .full-width-img { cursor: none; }
        /* Excepcion para trailer cuando esta activo para usar controles */
        .trailer-box.active { cursor: default !important; }

        /* --- NAVBAR --- */
        .navbar {
            display: flex; align-items: center; height: var(--navbar-height); background: rgba(0, 0, 0, 0.95); 
            backdrop-filter: blur(10px); border-bottom: 1px solid rgba(0, 255, 136, 0.2);
            padding: 0 30px; position: fixed; top: 0; width: 100%; z-index: 1000;
            justify-content: space-between; transition: all 0.3s ease;
        }
        .nav-left { display: flex; align-items: center; gap: 40px; }
        .brand-container { display: flex; align-items: center; gap: 10px; text-decoration: none; }
        .logo-pill {
            width: 26px; height: 46px; border-radius: 99px;
            background: linear-gradient(180deg, #fff 50%, var(--primary) 50%);
            transform: rotate(-30deg); box-shadow: 0 0 25px var(--primary); border: 2px solid #000;
        }
        .brand-name { font-family: 'Russo One'; font-size: 32px; color: #fff; text-transform: uppercase; letter-spacing: 2px; }

        .nav-links-container { 
            display: flex; gap: 30px; margin-left: 20px; align-items: center; 
        }

        .btn-play {
            background: var(--accent); padding: 10px 35px; font-size: 16px; color: white; 
            text-transform: uppercase; font-weight: 900; border: none;
            clip-path: polygon(0 0, 100% 0, 100% 70%, 90% 100%, 0 100%);
            transition: 0.2s; letter-spacing: 1px; box-shadow: 0 0 15px rgba(255, 42, 42, 0.4);
            white-space: nowrap; cursor: pointer !important;
        }
        .btn-play:hover { transform: scale(1.05); filter: brightness(1.2); }

        .nav-link { font-size: 14px; font-weight: 900; color: #666; text-transform: uppercase; letter-spacing: 1px; font-family: 'Russo One'; text-decoration: none; white-space: nowrap; }
        .nav-link:hover { color: #fff; text-shadow: 0 0 10px #fff; }

        .nav-dropdown-group { display: flex; gap: 20px; align-items: center; }
        .social-icon-link svg { width: 20px; height: 20px; fill: #888; transition: fill 0.2s; }
        .social-icon-link:hover svg { fill: #fff; }

        .dropdown { position: relative; display: flex; align-items: center; height: 100%; }
        .dropbtn { font-weight: 800; font-size: 14px; color: #fff; display: flex; align-items: center; gap: 8px; }
        .dropdown-content { display: none; position: absolute; top: 100%; right: 0; min-width: 180px; padding-top: 15px; }
        .dropdown-box { background: #111; border: 1px solid #333; border-radius: 6px; overflow: hidden; box-shadow: 0 10px 30px #000; }
        .dropdown-content a { padding: 12px 16px; font-size: 13px; font-weight: 600; color: #ccc; display: flex; align-items: center; gap: 10px; text-decoration: none; border-bottom: 1px solid #222; }
        .dropdown-content a:hover { background: #222; color: var(--primary); }
        .dropdown:hover .dropdown-content { display: block; }
        .dd-icon { width: 18px; height: 18px; border-radius: 50%; }

        #user-balance-display { display: none; font-family: 'Russo One'; color: var(--primary); font-size: 14px; text-shadow: 0 0 10px rgba(0,255,136,0.3); margin-right: 10px; }
        
        .btn-connect {
            background: transparent; border: 1px solid var(--primary); color: var(--primary);
            padding: 8px 24px; border-radius: 4px; font-size: 13px; font-weight: 800; text-transform: uppercase;
            transition: 0.3s; box-shadow: 0 0 5px var(--primary-dim); 
            z-index: 1001; position: relative; white-space: nowrap;
        }
        .btn-connect:hover { background: var(--primary); color: #000; box-shadow: 0 0 20px var(--primary); }
        .btn-disconnect { background: rgba(255, 42, 42, 0.1); border: 1px solid #ff4747; color: #ff4747; }
        .btn-disconnect:hover { background: #ff4747; color: white; box-shadow: 0 0 20px rgba(255, 42, 42, 0.6); }

        /* --- TICKER --- */
        .ticker-wrap {
            position: fixed; top: var(--navbar-height); width: 100%; height: 30px; background: rgba(0,0,0,0.6);
            backdrop-filter: blur(3px); border-bottom: 1px solid rgba(255,255,255,0.05); 
            overflow: hidden; z-index: 900; display: flex; align-items: center; transition: top 0.3s ease;
        }
        .ticker { display: flex; animation: ticker 40s linear infinite; white-space: nowrap; }
        .ticker-item { padding: 0 30px; font-size: 12px; font-weight: 600; color: #888; text-transform: uppercase; display: flex; align-items: center; gap: 10px; }
        @keyframes ticker { 0% { transform: translateX(0); } 100% { transform: translateX(-100%); } }

        /* HERO */
        .hero-video-wrapper { position: relative; width: 100%; height: 100vh; min-height: 500px; display: flex; align-items: center; justify-content: center; overflow: hidden; border-bottom: 1px solid var(--primary); }
        .hero-video { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: -1; filter: brightness(0.5); }
        .hero-main-content { z-index: 2; text-align: center; padding: 0 20px; margin-top: 60px; }
        .big-title { font-size: 90px; font-family: 'Russo One'; color: #fff; text-shadow: 0 0 30px var(--primary); margin: 0; line-height: 1; }
        .big-subtitle { font-size: 24px; color: var(--primary); font-weight: 800; text-transform: uppercase; letter-spacing: 8px; margin-top: 10px; }

        .content-container { padding: 100px 20px; display: flex; flex-direction: column; align-items: center; z-index: 5; position: relative; }
        
        .main-layout { display: flex; width: 100%; max-width: 1200px; gap: 30px; margin-bottom: 80px; flex-wrap: wrap; }

        /* --- ESTILOS MODO CINE (TRAILER) --- */
        .trailer-box { 
            flex: 2; min-width: 320px; background: #000; border: 1px solid #333; border-radius: 12px; 
            aspect-ratio: 16/9; display: flex; justify-content: center; align-items: center; 
            box-shadow: 0 0 50px #000; width: 100%; 
            position: relative; cursor: pointer;
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 10; overflow: hidden;
            transform: translateZ(0); /* Evita blur en transiciones */
        }

        .trailer-box video {
            width: 100%; height: 100%; object-fit: cover;
            opacity: 0.6; transition: opacity 0.3s;
        }

        /* TEXTO ABAJO DEL TODO */
        .trailer-hint {
            position: absolute; 
            bottom: 20px; /* PEGADO ABAJO */
            left: 50%; transform: translateX(-50%);
            z-index: 20; pointer-events: none;
            border: 1px solid rgba(255,255,255,0.3); padding: 10px 20px;
            background: rgba(0,0,0,0.6); border-radius: 30px; backdrop-filter: blur(4px);
            transition: opacity 0.3s;
            white-space: nowrap;
        }
        .trailer-hint span { font-family: 'Russo One', sans-serif; color: #fff; font-size: 12px; letter-spacing: 1px; }

        .trailer-box:hover video { opacity: 1; }
        .trailer-box:hover { border-color: var(--primary); box-shadow: 0 0 30px rgba(0,255,136,0.2); }

        /* TRAILER ACTIVE (SOLUCION NITIDEZ) */
        .trailer-box.active {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 80vw; max-width: 1000px; aspect-ratio: 16/9; height: auto;
            z-index: 10005 !important; /* Capa mas alta */
            border: 2px solid var(--primary);
            box-shadow: 0 0 100px rgba(0,255,136,0.5);
            background: #000;
        }
        .trailer-box.active video { 
            opacity: 1 !important; /* Nitidez total */
            filter: none !important;
        }
        .trailer-box.active .trailer-hint { opacity: 0; }

        .trailer-backdrop {
    display: none;
    position: fixed;
    inset: 0;
    z-index: 10001;
    background: rgba(0,0,0,0.9);
       }

/* el blur se aplica en un pseudo-elemento, no en el contenedor */
      /* ===== BLUR SOLO AL CONTENIDO (NO AL VIDEO) ===== */
#page-content{
  transition: filter 0.25s ease;
  will-change: filter;
}

body.trailer-open #page-content{
  filter: blur(10px);
}

/* ===== BACKDROP SOLO OSCURECE ===== */
.trailer-backdrop {
    display: none;
    position: fixed;
    inset: 0;
    z-index: 10001;
    background: rgba(0,0,0,0.85); /* Un poco m√°s transparente para ver el blur */
    backdrop-filter: blur(10px);   /* <--- ESTA ES LA CLAVE */
    -webkit-backdrop-filter: blur(10px); /* Para Safari */
}

.trailer-backdrop.active { display: block; }

        /* ------------------------------------- */

        .side-widget { flex: 1; min-width: 280px; background: var(--glass-bg); border: 1px solid var(--glass-border); border-radius: 12px; padding: 25px; display: flex; flex-direction: column; gap: 20px; backdrop-filter: blur(10px); width: 100%; }
        .widget-row { background: rgba(0,0,0,0.4); padding: 20px; border-radius: 8px; text-align: center; border-left: 4px solid var(--primary); }
        .widget-title { color: #666; font-size: 11px; letter-spacing: 2px; font-weight: 800; text-transform: uppercase; }
        .widget-val { font-size: 20px; font-weight: 700; color: #fff; margin-top: 5px; }

        .feature-block {
            display: flex; gap: 50px; align-items: center; margin-bottom: 40px; padding: 60px; border-radius: 20px;
            background: rgba(10, 10, 10, 0.4); border: 1px solid rgba(255,255,255,0.05); width: 100%; max-width: 1200px;
        }
        .feature-block.reverse { flex-direction: row-reverse; }
        .feature-text { flex: 1.2; }
        
        .category-tag { 
            color: var(--primary); 
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid rgba(0, 255, 136, 0.2);
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 11px; 
            font-weight: 900; 
            letter-spacing: 2px; 
            text-transform: uppercase; 
            margin-bottom: 15px; 
            display: inline-block; 
        }

        .feature-text h3 { font-family: 'Russo One'; font-size: 42px; color: #fff; margin: 15px 0; line-height: 1; }
        .feature-text p { color: #888; line-height: 1.6; font-size: 16px; margin-bottom: 15px; }
        .feature-images { flex: 1; display: flex; gap: 15px; width: 100%; justify-content: center; }

        .video-card { 
            background: #000; border: 1px solid #222; border-radius: 12px; 
            width: 100%; aspect-ratio: 16/9; display: flex; align-items: center; 
            justify-content: center; overflow: hidden; transition: 0.3s ease; 
        }
        .video-card:hover { border-color: var(--primary); background: #111; box-shadow: 0 0 20px rgba(0,255,136,0.1); }
        .video-card video { width: 100%; height: 100%; object-fit: cover; }

        .battle-modes-container {
            border: 2px solid var(--primary); background: rgba(15, 15, 15, 0.3); 
            border-radius: 24px; padding: 60px; text-align: center; margin: 80px 0; width: 100%; max-width: 1200px;
            backdrop-filter: blur(2px);
        }
        .battle-modes-container h2 { font-family: 'Russo One'; font-size: 56px; color: #fff; margin: 0; text-transform: uppercase; }
        .powered-by { color: var(--primary); font-family: 'Russo One'; font-size: 20px; letter-spacing: 3px; margin-bottom: 25px; display: block; }
        .mode-oracle-info { color: #888; font-size: 16px; max-width: 800px; margin: 0 auto 50px auto; line-height: 1.6; }
        
        .modes-grid { display: flex; gap: 30px; margin-bottom: 50px; flex-wrap: wrap;}
        .mode-card { 
            flex: 1; min-width: 300px; background: rgba(20,20,20,0.5); border: 1px solid #333; border-radius: 12px; 
            padding: 40px; text-align: left; transition: 0.3s ease; 
        }
        .mode-card:hover { border-color: var(--primary); background: #111; box-shadow: 0 0 20px rgba(0,255,136,0.1); }
        .mode-card.special { border-color: var(--accent); } 
        .mode-card h4 { font-family: 'Russo One'; font-size: 30px; color: #fff; margin: 10px 0; }
        .mode-card p { color: #aaa; font-size: 15px; line-height: 1.6; }

        .ca-box {
            background: #000; border: 1px solid #333; padding: 18px 30px; border-radius: 8px;
            display: inline-flex; align-items: center; gap: 15px; 
            transition: 0.3s ease; flex-wrap: wrap; justify-content: center;
        }
        .ca-box:hover { border-color: var(--primary); background: #111; box-shadow: 0 0 15px rgba(0,255,136,0.2); }
        .ca-text { font-family: monospace; color: #ccc; font-size: 16px; word-break: break-all; }
        .copy-tag { background: var(--primary); color: #000; font-size: 10px; font-weight: 900; padding: 4px 10px; border-radius: 4px; flex-shrink: 0;}

        /* SKILLS SECTION */
        .skills-section { width: 100%; max-width: 1200px; margin: 0 auto; text-align: center; }
        .skills-grid { display: flex; justify-content: center; gap: 12px; flex-wrap: wrap; margin-top: 50px; }
        
        .skill-card { 
            background: rgba(10, 10, 10, 0.8); border: 2px solid #222; width: 110px; height: 110px; 
            display: flex; flex-direction: column; align-items: center; justify-content: center; transition: 0.2s;
            position: relative; 
        }
        .skill-card:hover, .skill-card.active-mobile { 
            border-color: var(--gold); background: #222; 
            box-shadow: 0 0 25px rgba(255, 204, 0, 0.6); 
            transform: scale(1.1); z-index: 10;
        }
        
        .skill-icon { width: 40px; height: 40px; margin-bottom: 12px; }
        .skill-name { font-size: 10px; font-weight: 900; color: #666; font-family: 'Russo One'; letter-spacing: 1px; }
        
        /* --- TOOLTIP FLOTANTE --- */
        .skill-tooltip {
            position: fixed; width: 250px;
            background: rgba(10, 10, 10, 0.98); border: 2px solid var(--gold); border-radius: 8px;
            box-shadow: 0 10px 40px rgba(0,0,0,1), 0 0 20px rgba(255, 204, 0, 0.3);
            z-index: 999999; display: none; flex-direction: column;
            backdrop-filter: blur(10px); pointer-events: none; text-align: left;
            animation: fadeInTooltip 0.15s ease-out;
        }
        @keyframes fadeInTooltip { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .tooltip-img-container {
            width: 100%; height: 100px; background: #000; border-bottom: 1px solid #333;
            display: flex; align-items: center; justify-content: center; border-radius: 6px 6px 0 0;
            position: relative; overflow: hidden;
        }
        .tooltip-img-bg {
            position: absolute; width: 100%; height: 100%; 
            background-size: cover; background-position: center; opacity: 0.3; filter: blur(5px);
        }
        .tooltip-icon-main { width: 50px; height: 50px; z-index: 2; filter: drop-shadow(0 0 10px var(--gold)); }

        .tooltip-content { padding: 15px; }
        .tooltip-title { color: #fff; font-family: 'Russo One'; font-size: 16px; margin: 0 0 5px 0; text-transform: uppercase; }
        .tooltip-divider { width: 40px; height: 3px; background: var(--gold); margin-bottom: 10px; }
        .tooltip-desc { color: #ccc; font-size: 11px; line-height: 1.4; margin-bottom: 15px; }
        
        .tooltip-mode { 
            display: flex; align-items: center; gap: 6px; font-size: 9px; font-weight: bold; margin-top: 4px; 
            font-family: 'Russo One'; letter-spacing: 0.5px;
        }
        .mode-arcade-tag { color: #ccff00; }
        .mode-classic-tag { color: #00ffaa; }

        .full-width-img { 
            width: 100%; max-width: 1000px; border: 1px solid var(--primary); border-radius: 12px; 
            overflow: hidden; margin: 30px auto; background: #000;
        }
        .full-width-img video { width: 100%; display: block; object-fit: cover; transition: opacity 0.3s; }

        .section-container { padding: 100px 20px; border-top: 1px solid #222; display: flex; flex-direction: column; align-items: center; position: relative; }
        #quest { background: radial-gradient(circle at top, #0a1a0a, #000); }
        #shop { background: linear-gradient(180deg, #020202 0%, #150515 100%); }
        #ranking { background: linear-gradient(0deg, #050505 0%, #051015 100%); border-bottom: 1px solid #222; }
        .section-title { font-size: 48px; font-family: 'Russo One'; margin-bottom: 50px; text-transform: uppercase; text-align: center; }
        .placeholder-box { width: 100%; max-width: 700px; height: 300px; border: 2px dashed #333; background: rgba(0,0,0,0.4); border-radius: 20px; display: flex; align-items: center; justify-content: center; color: #444; }

        footer { 
            padding: 60px; text-align: center; background: #020202; border-top: none; font-size: 12px; color: #444; 
            position: relative; z-index: 50; 
        }
        footer a { color: #666; margin: 0 15px; text-decoration: none; font-weight: 800; display: inline-block; padding: 5px;}
        footer a:hover { color: var(--primary); }

        .reveal { opacity: 0; transform: translateY(30px); transition: 0.8s ease-out; }
        .reveal.active { opacity: 1; transform: translateY(0); }

        .modal-overlay { 
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0, 0, 0, 0.85); backdrop-filter: blur(5px); z-index: 10001; 
            align-items: center; justify-content: center;
        }
        .modal-box { 
            background: #0a0a0a; border: 1px solid var(--primary); border-radius: 16px; padding: 30px; 
            width: 100%; max-width: 400px; box-shadow: 0 0 40px rgba(0, 255, 136, 0.1); position: relative; 
            text-align: center; animation: slideUp 0.3s ease-out; margin: 20px;
        }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .modal-close { position: absolute; top: 15px; right: 20px; font-size: 24px; color: #666; font-weight: bold; }
        .modal-close:hover { color: #fff; }
        .modal-title { font-family: 'Russo One'; color: #fff; font-size: 20px; margin-bottom: 25px; text-transform: uppercase; }
        
        .wallet-option { 
            display: flex; align-items: center; gap: 15px; background: #111; border: 1px solid #333; 
            padding: 15px 20px; border-radius: 8px; margin-bottom: 12px; transition: 0.2s; 
        }
        .wallet-option:hover { background: #1a1a1a; border-color: var(--primary); transform: translateX(5px); }
        .wallet-option img { width: 32px; height: 32px; border-radius: 8px; object-fit: cover; }
        .wallet-option span { font-weight: 700; color: #e0e0e0; font-size: 15px; }

        /* --- MOBILE OPTIMIZATIONS FIXED --- */
        @media (max-width: 768px) {
            :root { --navbar-height: auto; } /* Altura autom√°tica en m√≥vil */
            body { cursor: auto !important; }
            #custom-cursor { display: none !important; }
            
            .navbar { 
                flex-direction: column; 
                padding: 10px 20px; 
                gap: 5px; /* Reducido para juntar m√°s los elementos */
                position: fixed; 
            }
            
            .nav-left { 
                flex-direction: column; 
                align-items: center; 
                width: 100%; 
                gap: 5px;
            }
            
            /* --- LOGO Y TITULO OCULTOS EN M√ìVIL --- */
            .brand-container { display: none !important; }

            /* CONTENEDOR DE ENLACES + BOT√ìN PLAY EN LA MISMA FILA SCROLLABLE */
            .nav-links-container {
                width: 100%; 
                margin: 0;
                overflow-x: auto; 
                white-space: nowrap;
                padding: 5px 0; /* Padding vertical reducido */
                gap: 15px;
                justify-content: flex-start; /* Alineado a la izquierda */
                scrollbar-width: none; /* Firefox */
                align-items: center;
            }
            .nav-links-container::-webkit-scrollbar { display: none; }

            /* EL BOT√ìN PLAY VERSI√ìN MINI PARA M√ìVIL */
            .btn-play { 
                width: auto !important; 
                text-align: center;
                font-size: 11px; 
                padding: 6px 16px; 
                flex-shrink: 0; 
                box-shadow: 0 0 10px rgba(255, 42, 42, 0.4);
            }
            
            .nav-link { font-size: 12px; }

            /* Wallet y Socials al final */
            .nav-dropdown-group { justify-content: space-between; width: 100%; margin-top: 5px;}
            .dropbtn span { display: none; } 
            .dropbtn { font-size: 12px; }
            .btn-connect { padding: 6px 12px; font-size: 10px; }

            /* Ticker ajustado visualmente por defecto (el script lo perfeccionar√°) */
            .ticker-wrap { position: fixed; top: 90px; z-index: 900; } 
            
            /* Ajuste de Hero */
            .hero-video-wrapper { padding-top: 0; height: 100vh; }
            .hero-main-content { margin-top: 0; }
            
            .big-title { font-size: 48px; }
            .big-subtitle { font-size: 16px; letter-spacing: 4px; }
            
            .main-layout { flex-direction: column; margin-top: 80px; } /* Menos margen top */
            .trailer-box { aspect-ratio: 16/9; width: 100%; }
            .side-widget { width: 100%; }
            
            .feature-block, .feature-block.reverse { 
                flex-direction: column-reverse; padding: 30px; gap: 20px;
            }
            .feature-text { text-align: center; }
            .feature-text h3 { font-size: 28px; }
            .feature-images { width: 100%; }
            
            .battle-modes-container { padding: 30px 20px; }
            .battle-modes-container h2 { font-size: 32px; }
            .modes-grid { flex-direction: column; }
            
            .skills-section h2 { font-size: 28px; }
            .section-title { font-size: 32px; }
            .section-container { padding: 60px 20px; }
        }
    </style>
</head>
<body>

    <div id="custom-cursor"></div>
    <div id="page-content">

    <!-- NAVBAR -->
    <nav class="navbar" id="main-navbar">
        <div class="nav-left">
            <div class="brand-container">
                <div class="logo-pill"></div>
                <span class="brand-name">PILLWARS</span>
            </div>
            
            <div class="nav-links-container">
                <button class="btn-play" onclick="window.location.href='game/'">PLAY NOW</button>
                <a href="#hero" class="nav-link">GAME</a>
                <a href="#quest" class="nav-link">QUEST</a>
                <a href="#shop" class="nav-link">STORE</a>
                <a href="#ranking" class="nav-link">LEADERBOARD</a>
            </div>
        </div>

        <div class="nav-dropdown-group">
            <a href="https://x.com/PillWars" target="_blank" class="social-icon-link">
                <svg viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path></svg>
            </a>
            <a href="https://t.me/pillwars" target="_blank" class="social-icon-link">
                <svg viewBox="0 0 24 24">
                   <path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 11.944 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/>
                </svg>
            </a>
            <span id="user-balance-display"></span>
            <div class="dropdown">
                <span class="dropbtn" id="price-btn"><span>$PILL</span> &nbsp; Loading... ‚ñæ</span>
                <div class="dropdown-content">
                    <div class="dropdown-box">
                        <a href="https://dexscreener.com/" target="_blank"><img src="https://dexscreener.com/favicon.ico" class="dd-icon"> Chart</a>
                        <a href="https://pump.fun/" target="_blank"><img src="https://pump.fun/favicon.ico" class="dd-icon" onerror="this.src='https://i.imgur.com/2etxs7Q.png'"> Buy $PILL</a>
                    </div>
                </div>
            </div>
            <button class="btn-connect" onclick="App.Wallet.toggle()" id="wallet-btn">CONNECT WALLET</button>
        </div>
    </nav>

    <!-- TICKER -->
    <div class="ticker-wrap" id="ticker-wrap"><div class="ticker"><div class="ticker-item">Loading Market Data...</div></div></div>

    <!-- HERO -->
    <div class="hero-video-wrapper" id="hero">
        <video autoplay muted loop playsinline class="hero-video"><source src="https://assets.mixkit.co/videos/preview/mixkit-digital-animation-of-a-green-grid-996-large.mp4" type="video/mp4"></video>
        <div class="hero-main-content">
            <h1 class="big-title">PILLWARS</h1>
            <div class="big-subtitle">THE CRYPTO ARENA</div>
        </div>
    </div>

    <div class="content-container">
        
        <div class="main-layout">
            
            <!-- TRAILER BOX MEJORADO -->
            <div class="trailer-box" id="main-trailer" onclick="toggleTrailerMode()">
                <div class="trailer-hint">
                    <span>üîä TAP TO EXPAND & UNMUTE</span>
                </div>
                <video id="trailer-vid" autoplay muted loop playsinline>
                    <source src="video/Trailer.mp4" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
            </div>

            <div class="side-widget">
                <div class="widget-row"><div class="widget-title">MARKET CAP</div><div class="widget-val" id="widget-mcap">Loading...</div></div>
                <div class="widget-row"><div class="widget-title">VOLUME</div><div class="widget-val" id="widget-vol">Loading...</div></div>
            </div>
        </div>

        <div class="intro-text reveal" style="text-align: center; margin-bottom: 80px;">
            <h2 class="holo-text" style="font-size: 42px; text-transform: uppercase;">EAT. GROW. PROFIT.</h2>
            <p style="max-width: 900px; margin: 0 auto; color: #888; line-height: 1.6; font-size: 18px;">PillWars brings back the addictive chaos of classic browser games like Agar.io. Enter the arena, devour smaller pills, and grow your mass to dominate the map. But size isn't everything; master your special abilities to outsmart your opponents. Learn more below:</p>
        </div>

        <!-- SECCION 1 (SPLIT) - AUTOPLAY ACTIVADO -->
        <div class="feature-block reveal">
            <div class="feature-text">
                <span class="category-tag">CORE MECHANICS</span>
                <h3>THE SPLIT<br>EXECUTION</h3>
                <p>In the arena, speed is a weapon. The <b>Split mechanic</b> allows you to divide your mass instantly, launching half of your body forward at high velocity. Use it as a <b>projectile</b> to surprise enemies or as an <b>escape tool</b>.</p>
            </div>
            <div class="feature-images">
                <div class="video-card">
                    <video autoplay muted loop playsinline>
                        <source src="video/Split.mp4" type="video/mp4">
                        Your browser does not support the video tag.
                    </video>
                </div>
            </div>
        </div>

        <!-- SECCION 2 (VIRUS) - AUTOPLAY ACTIVADO -->
        <div class="feature-block reverse reveal">
            <div class="feature-text">
                <span class="category-tag">RISK & REWARD</span>
                <h3>TACTICAL<br>VIRAL WARFARE</h3>
                <p>Green Spikes are no longer your enemies. In PillWars, <b>Viruses</b> are growth catalysts. While they shred large players, they award <b>massive bonus mass</b> upon collision. It's the ultimate strategic trade-off.</p>
            </div>
            <div class="feature-images">
                <div class="video-card">
                    <video autoplay muted loop playsinline>
                        <source src="video/Virus.mp4" type="video/mp4">
                        Your browser does not support the video tag.
                    </video>
                </div>
            </div>
        </div>

        <!-- SECCION 3 (SHOOT / VIRAL BALLISTICS) - AUTOPLAY ACTIVADO -->
        <div class="feature-block reveal">
            <div class="feature-text">
                <span class="category-tag">OFFENSIVE STRATEGY</span>
                <h3>VIRAL<br>BALLISTICS</h3>
                <p>Weaponize your mass with <b>Precision Shooting (Key 1)</b>. By ejecting small pieces of yourself, you can feed allies or, more importantly, <b>trigger Viruses</b>. Pop giant enemies from a safe distance and scavenge their remains.</p>
            </div>
            <div class="feature-images">
                <div class="video-card">
                    <video autoplay muted loop playsinline>
                        <source src="video/Viral.mp4" type="video/mp4">
                        Your browser does not support the video tag.
                    </video>
                </div>
            </div>
        </div>

        <!-- BATTLE MODES -->
        <div class="battle-modes-container reveal">
            <h2>BATTLE MODES</h2>
            <span class="powered-by">POWERED BY $PILL</span>
            <p class="mode-oracle-info">To enter the arena, you must use <b>$PILL</b> tokens. Our Oracle updates entry costs every 5 minutes to ensure fair competition regardless of price volatility.</p>
            
            <div class="modes-grid">
                <div class="mode-card">
                    <span class="category-tag">STANDARD EXPERIENCE</span>
                    <h4>CLASSIC</h4>
                    <p>The legendary browser experience. A massive open map with no time limits. Only basic mechanics: splitting and shooting. Rule the lobby by mass.</p>
                </div>
                <div class="mode-card special">
                    <span class="category-tag" style="background:rgba(255, 42, 42, 0.1); border-color: rgba(255, 42, 42, 0.3); color:var(--accent)">ROGUELIKE EVOLUTION</span>
                    <h4>ARCADE</h4>
                    <p>High-stakes action in 3:50 minute matches. Start from scratch and evolve your pill by choosing Randomized Skills every 30 seconds.</p>
                </div>
            </div>

            <div class="ca-section" style="border-top: 1px solid #333; padding-top: 40px;">
                <span class="category-tag" style="margin-bottom: 15px; display: inline-block;">OFFICIAL CONTRACT ADDRESS</span>
                <br>
                <div class="ca-box" onclick="App.UI.copyCA()">
                    <span class="ca-text" id="ca-text">ED5nyyWEzpPPiWimP8vYm7sD7TD3LAt3Q3gRTWHzPJBY</span>
                    <span class="copy-tag">COPY</span>
                </div>
                <div id="copy-feedback" style="font-size:11px; color:var(--primary); height:15px; margin-top:5px;"></div>
            </div>
        </div>

        <!-- SKILLS SECTION INTERACTIVE -->
        <div class="skills-section reveal">
            <h2 style="font-family:'Russo One'; font-size: 40px; text-transform: uppercase;">THE SKILL ARSENAL</h2>
            
            <div class="skills-grid" id="skills-grid-container">
                <div class="skill-card" onmouseenter="App.UI.showSkill(event, 'shoot')" onclick="App.UI.toggleSkillMobile(event, 'shoot')" onmouseleave="App.UI.hideSkill()">
                    <img src="img/shoot.png" class="skill-icon"><div class="skill-name">SHOT</div>
                </div>
                <div class="skill-card" onmouseenter="App.UI.showSkill(event, 'sprint')" onclick="App.UI.toggleSkillMobile(event, 'sprint')" onmouseleave="App.UI.hideSkill()">
                    <img src="img/sprint.png" class="skill-icon"><div class="skill-name">SPRINT</div>
                </div>
                <div class="skill-card" onmouseenter="App.UI.showSkill(event, 'tp')" onclick="App.UI.toggleSkillMobile(event, 'tp')" onmouseleave="App.UI.hideSkill()">
                    <img src="img/tp.png" class="skill-icon"><div class="skill-name">BLINK</div>
                </div>
                <div class="skill-card" onmouseenter="App.UI.showSkill(event, 'magnet')" onclick="App.UI.toggleSkillMobile(event, 'magnet')" onmouseleave="App.UI.hideSkill()">
                    <img src="img/iman.png" class="skill-icon"><div class="skill-name">MAGNET</div>
                </div>
                <div class="skill-card" onmouseenter="App.UI.showSkill(event, 'clone')" onclick="App.UI.toggleSkillMobile(event, 'clone')" onmouseleave="App.UI.hideSkill()">
                    <img src="img/clon.png" class="skill-icon"><div class="skill-name">CLONE</div>
                </div>
                <div class="skill-card" onmouseenter="App.UI.showSkill(event, 'shield')" onclick="App.UI.toggleSkillMobile(event, 'shield')" onmouseleave="App.UI.hideSkill()">
                    <img src="img/inmune.png" class="skill-icon"><div class="skill-name">SHIELD</div>
                </div>
                <div class="skill-card" onmouseenter="App.UI.showSkill(event, 'plus')" onclick="App.UI.toggleSkillMobile(event, 'plus')" onmouseleave="App.UI.hideSkill()">
                    <img src="img/big.png" class="skill-icon"><div class="skill-name">PLUS</div>
                </div>
                <div class="skill-card" onmouseenter="App.UI.showSkill(event, 'gamble')" onclick="App.UI.toggleSkillMobile(event, 'gamble')" onmouseleave="App.UI.hideSkill()">
                    <img src="img/random.png" class="skill-icon"><div class="skill-name">GAMBLE</div>
                </div>
            </div>
            
            <div class="intro-text reveal" style="margin-top: 100px; text-align: center;">
                <h2 class="holo-text" style="font-size: 42px;">DOMINATE THE LOBBY</h2>
                <div class="full-width-img">
                    <video muted loop playsinline preload="metadata">
                        <source src="video/Gameplay.mp4" type="video/mp4">
                        Your browser does not support the video tag.
                    </video>
                </div>
            </div>
        </div>
    </div>

    <!-- SECCIONES -->
    <div id="quest" class="section-container">
        <h1 class="section-title holo-text">Daily Quests</h1>
        <div class="placeholder-box"><h3>COMING SOON</h3></div>
    </div>
    <div id="shop" class="section-container">
        <h1 class="section-title holo-text">Skin Shop</h1>
        <div class="placeholder-box" style="border-color: var(--accent);"><h3>NFT MARKETPLACE</h3></div>
    </div>
    <div id="ranking" class="section-container">
        <h1 class="section-title holo-text">Global Elite</h1>
        <div class="placeholder-box"><h3>FETCHING LEADERBOARD...</h3></div>
    </div>

    <!-- FOOTER -->
    <footer id="main-footer">
        <p>&copy; 2025 PillWars.io | The Crypto Arena.</p>
        <p>
         <a href="https://x.com/PillWars" target="_blank">Twitter</a>
         <a href="https://t.me/pillwars" target="_blank">Telegram</a>
         <a href="#">PlayBook</a>
        </p>
    </footer>
        
    </div>
    <!-- WALLET MODAL -->
    <div id="wallet-modal" class="modal-overlay">
        <div class="modal-box">
            <span class="modal-close" onclick="App.Wallet.closeModal()">√ó</span>
            <div class="modal-title">Connect Wallet</div>
            <div class="wallet-option" onclick="App.Wallet.connectPhantom()">
                <img src="https://i.imgur.com/esN0veD.png" alt="Phantom"><span>Phantom</span>
            </div>
            <div class="wallet-option"><img src="https://cdn.prod.website-files.com/66e480f0e9eccea9c231ce92/6839e3bc01620952b0aff662_Backpack-logo.png" alt="Backpack"><span>Backpack (Soon)</span></div>
            <div class="wallet-option"><img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTBPpBT5Ui3yxM00P2F0X07baqLSw3o2xeoPQ&s" alt="Solflare"><span>Solflare (Soon)</span></div>
        </div>
    </div>

    <!-- FONDO DEL MODO CINE -->
    <div id="trailer-backdrop" class="trailer-backdrop" onclick="toggleTrailerMode()"></div>

    <!-- TOOLTIP HTML -->
    <div id="skill-tooltip" class="skill-tooltip">
        <div class="tooltip-img-container">
            <div id="tooltip-bg" class="tooltip-img-bg"></div>
            <img id="tooltip-icon" src="" class="tooltip-icon-main">
        </div>
        <div class="tooltip-content">
            <h4 id="tooltip-title" class="tooltip-title">NAME</h4>
            <div class="tooltip-divider"></div>
            <p id="tooltip-desc" class="tooltip-desc">Description goes here.</p>
            
            <div class="tooltip-mode mode-arcade-tag">
                <span>‚óè</span> AVAILABLE IN ARCADE MODE
            </div>
            <div id="tooltip-classic-tag" class="tooltip-mode mode-classic-tag" style="display:none;">
                <span>‚óè</span> DEFAULT MECHANIC IN CLASSIC MODE
            </div>
        </div>
    </div>

    <script>
        const DOM = {
            cursor: document.getElementById('custom-cursor'),
            walletModal: document.getElementById('wallet-modal'),
            walletBtn: document.getElementById('wallet-btn'),
            footer: document.getElementById('main-footer'),
            balanceDisplay: document.getElementById('user-balance-display'),
            ticker: document.querySelector('.ticker'),
            tickerWrap: document.getElementById('ticker-wrap'),
            navbar: document.getElementById('main-navbar'),
            widgetMcap: document.getElementById('widget-mcap'),
            widgetVol: document.getElementById('widget-vol'), 
            priceBtn: document.getElementById('price-btn'),
            caText: document.getElementById("ca-text"),
            copyFeedback: document.getElementById("copy-feedback"),
            // TOOLTIP DOM
            tooltip: document.getElementById('skill-tooltip'),
            ttTitle: document.getElementById('tooltip-title'),
            ttDesc: document.getElementById('tooltip-desc'),
            ttIcon: document.getElementById('tooltip-icon'),
            ttBg: document.getElementById('tooltip-bg'),
            ttClassic: document.getElementById('tooltip-classic-tag')
        };

        const SKILL_DB = {
            clone: { name: "CLON", img: "img/clon.png", desc: "THE FARMER. Shoots a mass projectile. IMPORTANT: If it hits a VIRUS, it clones it and grants you a NEW SKILL card. Cooldown: 1s." },
            shoot: { name: "SHOOT", img: "img/shoot.png", desc: "OFFENSIVE. Fires mass projectiles to damage enemies or push viruses. Does not grant skills. Cost: 2500 Mass." },
            sprint: { name: "SPRINT", img: "img/sprint.png", desc: "MOBILITY. Boosts movement speed by 50% for 10 seconds. Great for chasing or escaping. Passive effect: Gold aura." },
            tp: { name: "TELEPORT", img: "img/tp.png", desc: "EVASION. Instantly teleports all your cells to a random safe location near your center. Use to dodge attacks. Cooldown: 20s." },
            magnet: { name: "MAGNET", img: "img/iman.png", desc: "UTILITY. Automatically pulls nearby food pellets towards your cells for 8 seconds. Radius: 200px." },
            shield: { name: "SHIELD", img: "img/inmune.png", desc: "DEFENSE. Grants total immunity to viruses and being eaten by larger players for 3 seconds. Visual: Purple forcefield." },
            plus: { name: "PLUS", img: "img/big.png", desc: "GROWTH. Instantly grants a large amount of mass (5k - 12k) distributed among your cells." },
            gamble: { name: "GAMBLE", img: "img/random.png", desc: "RISK. 50% chance to gain 15,000 Mass (JACKPOT). 50% chance to lose 5,000 Mass. Do you feel lucky?" }
        };

        const App = {
            // RPC PUBLICNODE (MAS ESTABLE QUE OFICIAL PARA WEBS)
            Config: { Token: "777oHV1fPsv6m2vHDGBsJefKXhV4WA9m3LDqUdY5wiX2", RPC: "https://solana-rpc.publicnode.com" },
            isTouch: false,

            UI: {
                activeSkill: null, // Para rastrear skill abierta en movil

                init: () => {
                    // DETECT TOUCH
                    App.isTouch = ('ontouchstart' in window) || (navigator.maxTouchPoints > 0);
                    
                    if (!App.isTouch) {
                        App.UI.setupCursor();
                        DOM.cursor.style.display = 'block';
                    }

                    // AUTO ADJUST TICKER POSITION
                    const adjustTicker = () => {
                        if (window.innerWidth <= 768) {
                            // En m√≥vil, la altura depende del contenido. Medimos la navbar y aplicamos al ticker.
                            const h = DOM.navbar.offsetHeight;
                            DOM.tickerWrap.style.top = h + 'px';
                        } else {
                            // En PC usamos la variable CSS por defecto
                            DOM.tickerWrap.style.top = '80px'; 
                        }
                    };
                    
                    // Ejecutar ajuste al cargar y al redimensionar
                    adjustTicker();
                    window.addEventListener('resize', adjustTicker);
                    // Un peque√±o delay por si las fuentes cargan tarde y cambian la altura
                    setTimeout(adjustTicker, 500);

                    App.UI.setupScroll();
                    // SOLO PARA EL VIDEO DE GAMEPLAY GRANDE
                    App.UI.setupVideoHover(); 
                    
                    window.onclick = (e) => { 
                        if (e.target == DOM.walletModal) App.Wallet.closeModal(); 
                        
                        // CIERRA TOOLTIP AL TOCAR FUERA (SOLO MOVIL)
                        if (App.isTouch && App.UI.activeSkill) {
                            if (!e.target.closest('.skill-card') && !e.target.closest('.skill-tooltip')) {
                                App.UI.hideSkill();
                                App.UI.activeSkill = null;
                                // Remover clase activa de cards
                                document.querySelectorAll('.skill-card').forEach(c => c.classList.remove('active-mobile'));
                            }
                        }
                    };
                },
                setupCursor: () => {
                    document.addEventListener('mousemove', (e) => {
                        DOM.cursor.style.left = e.clientX + 'px'; 
                        DOM.cursor.style.top = e.clientY + 'px';
                        
                        const target = e.target;
                        const isNavbar = target.closest('.navbar');
                        const isFooter = target.closest('footer');
                        const isModal = target.closest('.modal-overlay');
                        const isTrailer = target.closest('.trailer-box');
                        
                        if (isNavbar || isFooter || isModal || isTrailer) {
                            DOM.cursor.style.opacity = '0'; 
                        } else {
                            DOM.cursor.style.opacity = '1'; 
                        }
                    });
                    document.addEventListener('mousedown', () => DOM.cursor.classList.add('clicking'));
                    document.addEventListener('mouseup', () => DOM.cursor.classList.remove('clicking'));
                },
                setupScroll: () => {
                    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                        anchor.addEventListener('click', function (e) {
                            e.preventDefault();
                            const targetId = this.getAttribute('href');
                            const targetSection = document.querySelector(targetId);
                            if (targetSection) {
                                targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                            }
                        });
                    });

                    const reveal = () => {
                        document.querySelectorAll(".reveal").forEach(el => {
                            if (el.getBoundingClientRect().top < window.innerHeight - 100) el.classList.add("active");
                        });
                    };
                    window.addEventListener("scroll", reveal); reveal();
                },
                setupVideoHover: () => {
                    // SOLO APLICAMOS HOVER EFFECT AL VIDEO GRANDE DEL FINAL
                    const videos = document.querySelectorAll('.full-width-img video');
                    videos.forEach(video => {
                        // En movil reproducir si es posible
                        if(App.isTouch) {
                            video.play().catch(() => {}); // Intentar autoplay silencioso
                        } else {
                            video.pause(); 
                            video.currentTime = 0; 
                            const container = video.parentElement;
                            container.addEventListener('mouseenter', () => {
                                video.play().catch(e => console.log("User gesture needed:", e));
                            });
                            container.addEventListener('mouseleave', () => {
                                video.pause();
                            });
                        }
                    });
                },
                copyCA: () => {
                    navigator.clipboard.writeText(DOM.caText.innerText).then(() => {
                        DOM.copyFeedback.innerText = "COPIED TO CLIPBOARD!";
                        setTimeout(() => DOM.copyFeedback.innerText = "", 2000);
                    });
                },
                
                showSkill: (e, key) => {
                    if (App.isTouch) return; // En movil usamos click
                    App.UI.renderTooltip(e, key);
                },
                
                toggleSkillMobile: (e, key) => {
                    if (!App.isTouch) return;
                    
                    if (App.UI.activeSkill === key) {
                        App.UI.hideSkill();
                        App.UI.activeSkill = null;
                        e.currentTarget.classList.remove('active-mobile');
                        return;
                    }

                    document.querySelectorAll('.skill-card').forEach(c => c.classList.remove('active-mobile'));
                    e.currentTarget.classList.add('active-mobile');
                    
                    App.UI.activeSkill = key;
                    App.UI.renderTooltip(e, key);
                },

                renderTooltip: (e, key) => {
                    const data = SKILL_DB[key];
                    if (!data) return;

                    DOM.ttTitle.innerText = data.name;
                    DOM.ttDesc.innerText = data.desc;
                    DOM.ttIcon.src = data.img;
                    DOM.ttBg.style.backgroundImage = `url('${data.img}')`;

                    if (key === 'shoot') {
                        DOM.ttClassic.style.display = 'flex';
                    } else {
                        DOM.ttClassic.style.display = 'none';
                    }

                    const card = e.currentTarget;
                    const rect = card.getBoundingClientRect();
                    const toolTipWidth = 250; 
                    const toolTipHeight = 320; 

                    let leftPos = (rect.left + (rect.width / 2) - (toolTipWidth / 2));
                    if (leftPos < 10) leftPos = 10;
                    if (leftPos + toolTipWidth > window.innerWidth) leftPos = window.innerWidth - toolTipWidth - 10;

                    let topPos = rect.top - toolTipHeight + 40; 
                    if (topPos < 0) topPos = rect.bottom + 10;

                    DOM.tooltip.style.left = leftPos + 'px';
                    DOM.tooltip.style.top = topPos + 'px';
                    DOM.tooltip.style.display = 'flex';
                },
                hideSkill: () => {
                    DOM.tooltip.style.display = 'none';
                }
            },

            Wallet: {
                address: null,
                toggle: () => {
                    if (App.Wallet.address) App.Wallet.disconnect();
                    else DOM.walletModal.style.display = 'flex';
                },
                closeModal: () => { DOM.walletModal.style.display = 'none'; },
                connectPhantom: async () => {
                    App.Wallet.closeModal();
                    if ("solana" in window) {
                        try {
                            const resp = await window.solana.connect();
                            App.Wallet.address = resp.publicKey.toString();
                            await window.solana.signMessage(new TextEncoder().encode("Welcome to PillWars!"), "utf8");
                            DOM.walletBtn.innerText = "DISCONNECT " + App.Wallet.address.slice(0, 4) + '...';
                            DOM.walletBtn.classList.add('btn-disconnect');
                            App.Market.fetchBalance(App.Wallet.address);
                        } catch (err) { console.error(err); alert("Connection failed or cancelled."); }
                    } else { 
                        window.open("https://phantom.app/", "_blank"); 
                    }
                },
                disconnect: () => {
                    if("solana" in window) window.solana.disconnect();
                    App.Wallet.address = null;
                    DOM.walletBtn.innerText = "CONNECT WALLET";
                    DOM.walletBtn.classList.remove('btn-disconnect');
                    DOM.balanceDisplay.style.display = 'none';
                }
            },

            Market: {
                fetchBalance: async (wallet) => {
                    DOM.balanceDisplay.innerText = "Scanning...";
                    DOM.balanceDisplay.style.display = 'inline-block';
                    
                    console.log("Connecting to RPC:", App.Config.RPC);

                    try {
                        const res = await fetch(App.Config.RPC, {
                            method: 'POST', 
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ 
                                jsonrpc: "2.0", 
                                id: 1, 
                                method: "getTokenAccountsByOwner", 
                                params: [
                                    wallet, 
                                    { mint: App.Config.Token }, 
                                    { encoding: "jsonParsed" }
                                ] 
                            })
                        });
                        
                        const data = await res.json();
                        
                        if (data.error) {
                            console.error("RPC Error:", data.error);
                            DOM.balanceDisplay.innerText = "Net Err"; 
                            return;
                        }

                        if (!data.result || !data.result.value || data.result.value.length === 0) {
                            console.log("Wallet has no tokens (Balance 0)");
                            DOM.balanceDisplay.innerText = "0 $PILL";
                            return;
                        }

                        const amount = parseFloat(data.result.value[0].account.data.parsed.info.tokenAmount.uiAmountString).toLocaleString('en-US', {maximumFractionDigits: 0});
                        DOM.balanceDisplay.innerText = `${amount} $PILL`;

                    } catch (e) { 
                        console.error("Connection Failed:", e);
                        DOM.balanceDisplay.innerText = "Net Err"; 
                    }
                },
                updateTicker: async () => {
                    try {
                        const res = await fetch(`https://api.dexscreener.com/latest/dex/tokens/${App.Config.Token}`);
                        const data = await res.json();
                        if (!data.pairs || data.pairs.length === 0) return;

                        const p = data.pairs[0];
                        const price = parseFloat(p.priceUsd).toFixed(6);
                        const chg = p.priceChange.h24;
                        const vol = parseFloat(p.volume.h24).toLocaleString('en-US', { style: 'currency', currency: 'USD', maximumFractionDigits: 0 });
                        const mcap = p.fdv ? parseFloat(p.fdv).toLocaleString('en-US', { style: 'currency', currency: 'USD', maximumFractionDigits: 0 }) : "N/A";

                        if(DOM.widgetMcap) DOM.widgetMcap.innerHTML = mcap;
                        if(DOM.widgetVol) DOM.widgetVol.innerHTML = vol; 
                        if(DOM.priceBtn) DOM.priceBtn.innerHTML = `<span>$PILL</span> &nbsp; $${price} ‚ñæ`;

                        const col = chg >= 0 ? '#00ff88' : '#ff4747';
                        const sign = chg >= 0 ? '+' : '';
                        
                        const item = `<div class="ticker-item">PRICE: <b style="color:#fff;">$${price}</b></div>
                                      <div class="ticker-item" style="color:${col}">24H: <b>${sign}${chg}%</b></div>
                                      <div class="ticker-item">MCAP: <b style="color:#fff;">${mcap}</b></div>
                                      <div class="ticker-item">VOL: <b style="color:gold;">${vol}</b></div>
                                      <div class="ticker-item">TRENDING #1</div>`;
                        
                        DOM.ticker.innerHTML = item + item + item; 
                    } catch (e) { console.log("Market data unavailable"); }
                }
            }
        };

// --- TRAILER MODE LOGIC (CORREGIDO) ---
let isTrailerOpen = false;

function toggleTrailerMode() {
    const box = document.getElementById('main-trailer');
    const vid = document.getElementById('trailer-vid');
    const backdrop = document.getElementById('trailer-backdrop');
    
    // Referencias para saber d√≥nde devolver el video
    const layout = document.querySelector('.main-layout');
    const widget = document.querySelector('.side-widget');

    if (isTrailerOpen) {
        // --- CERRAR ---
        isTrailerOpen = false;
        document.body.classList.remove('trailer-open');

        box.classList.remove('active');
        backdrop.classList.remove('active');

        vid.muted = true;
        vid.controls = false;
        
        // DEVOLVER A SU SITIO ORIGINAL (Insertar antes del widget lateral)
        // Esperamos 300ms para que termine la transici√≥n de opacidad/tama√±o si quieres, 
        // pero hacerlo inmediato evita saltos visuales raros en el layout.
        layout.insertBefore(box, widget);
        
        // Restaurar scroll si fuera necesario, aunque tu CSS maneja overflow.

    } else {
        // --- ABRIR ---
        isTrailerOpen = true;
        document.body.classList.add('trailer-open');
        
        // MOVER AL BODY (Fuera de #page-content para evitar el blur)
        document.body.appendChild(box);

        // Peque√±o timeout para asegurar que el navegador procese el movimiento del DOM
        // antes de aplicar la clase .active que inicia la transici√≥n CSS
        setTimeout(() => {
            box.classList.add('active');
            backdrop.classList.add('active');
        }, 10);

        vid.muted = false;
        vid.controls = true;
        vid.play();
    }
}


        App.UI.init();
        App.Market.updateTicker();
        setInterval(App.Market.updateTicker, 30000);
    </script>
</body>
</html>
